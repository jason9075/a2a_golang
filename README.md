# A2A è·¨ Agent å”ä½œå±•ç¤ºï¼šå…¬å¸å·®æ—…åŠ©æ‰‹

æœ¬ç¯„ä¾‹å±•ç¤ºäº†å…©å€‹ç¨ç«‹çš„ Agentï¼ˆåŠ©ç† A èˆ‡ è²¡å‹™ Bï¼‰å¦‚ä½•é€é Google A2A å”å®šé€²è¡Œè¤‡é›œçš„å•†å‹™å”ä½œã€‚

## ğŸ’¡ å±•ç¤ºé‡é»
1.  **åƒäººä¸€æ¨£å°è©±**ï¼šAgent ä¹‹é–“ä¸åªæ˜¯å‚³è³‡æ–™ï¼Œè€Œæ˜¯èƒ½ç†è§£ã€Œä¸Šä¸‹æ–‡ã€èˆ‡ã€Œä»»å‹™ç‹€æ…‹ã€ã€‚
2.  **æ¨™æº–åŒ–ä»‹é¢**ï¼šä¸ç®¡ Agent æ˜¯ç”¨ Goã€Python é‚„æ˜¯ Java å¯«çš„ï¼Œåªè¦ç¬¦åˆ A2Aï¼Œå°±èƒ½ç›´æ¥å°è©±ã€‚
3.  **å³æ™‚é€æ˜**ï¼šé€é SSE (ä¸²æµ) æŠ€è¡“ï¼Œè€é—†å¯ä»¥å³æ™‚çœ‹åˆ° Agent çš„å·¥ä½œé€²åº¦ï¼Œè€Œä¸æ˜¯åœ¨è¢å¹•å‰ç™¼å‘†ã€‚

---

## ğŸš€ å¦‚ä½•åŸ·è¡Œ

è«‹ç¢ºä¿æ‚¨åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„ä¸‹ï¼Œä¸¦å·²é€²å…¥å…·å‚™ Go ç’°å¢ƒçš„ Nix Shellã€‚

### ç¬¬ä¸€æ­¥ï¼šå•Ÿå‹•æœå‹™ç«¯ (Agent B - è²¡å‹™)
æ‰“é–‹ä¸€å€‹çµ‚ç«¯æ©Ÿï¼ŒåŸ·è¡Œï¼š
```bash
go run cmd/agent_b/main.go
# æˆ–è€…ä½¿ç”¨ Justfile
just run-b
```
æ‚¨æœƒçœ‹åˆ° `ğŸš€ Agent B (è²¡å‹™å°ˆå“¡) å·²å•Ÿå‹•`ã€‚

### ç¬¬äºŒæ­¥ï¼šåŸ·è¡Œæ¸¬è©¦å®¢æˆ¶ç«¯ (Agent A - åŠ©ç†)
æ‰“é–‹å¦ä¸€å€‹çµ‚ç«¯æ©Ÿï¼ŒåŸ·è¡Œï¼š
```bash
go run cmd/agent_a/main.go
# æˆ–è€…ä½¿ç”¨ Justfile
just run-a
```

---

## ğŸ§ª æ¸¬è©¦èˆ‡é©—è­‰

æœ¬å°ˆæ¡ˆåŒ…å«å®Œæ•´çš„å–®å…ƒæ¸¬è©¦èˆ‡æ•´åˆæ¸¬è©¦ã€‚

### åŸ·è¡Œå–®å…ƒæ¸¬è©¦
```bash
# åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
go test ./... -v

# æˆ–è€…ä½¿ç”¨ Justfile
just test
```

### åŸ·è¡Œæ•´åˆæ¸¬è©¦ (Github Actions)
CI æµç¨‹æœƒè‡ªå‹•åŸ·è¡Œä»¥ä¸‹æ­¥é©Ÿï¼š
1.  å•Ÿå‹• Agent B (Server)
2.  ç­‰å¾… Server å°±ç·’
3.  åŸ·è¡Œ Agent A (Client) è·‘å®Œæ‰€æœ‰è…³æœ¬
4.  è‹¥ä»»ä¸€ç’°ç¯€å¤±æ•—ï¼ŒCI å³åˆ¤å®šå¤±æ•—

---

## ğŸ“¡ A2A é€šè¨Šå”å®šæ ¼å¼ (JSON-RPC 2.0)

Agent A èˆ‡ Agent B ä¹‹é–“é€éæ¨™æº– HTTP POST é€²è¡Œæºé€šã€‚

### 1. ç™¼é€è¨Šæ¯ (Request)
**Method**: `message/send`

```json
{
  "jsonrpc": "2.0",
  "id": "req-1700000001",
  "method": "message/send",
  "params": {
    "id": "travel-task-123",
    "message": {
      "role": "user",
      "parts": [
        { "text": "è€é—†ä¸‹é€±ä¸€è¦å»å°åŒ—å‡ºå·®..." }
      ]
    }
  }
}
```

### 2. å›æ‡‰è¨Šæ¯ (Response)
**Status**: `200 OK`

```json
{
  "jsonrpc": "2.0",
  "id": "req-1700000001",
  "result": {
    "id": "travel-task-123",
    "status": {
      "state": "working"
    },
    "metadata": {
      "reply": "ã€ç¬¬ä¸€å›åˆã€‘å·²ç‚ºæ‚¨æ‰¾åˆ°å…©é–“ç¬¦åˆæ”¿ç­–çš„é£¯åº—..."
    }
  }
}
```

### 3. ä¸²æµå›æ‡‰ (SSE)
**Method**: `message/stream` (Client ç™¼é€é¡ä¼¼ `message/send` çš„è«‹æ±‚ï¼Œä½†æŒ‡å®šæ­¤ Method)

Server æœƒå›å‚³ `Content-Type: text/event-stream`ï¼Œä¸¦æŒçºŒæ¨é€ JSON æ•¸æ“šï¼š

```json
// Event 1: æ‰“å­—æ©Ÿæ•ˆæœ
{
  "result": {
    "id": "travel-task-123",
    "artifact": {
      "parts": [{ "text": "æ­£" }]
    }
  }
}

// Event 2: æ‰“å­—æ©Ÿæ•ˆæœ
{
  "result": {
    "id": "travel-task-123",
    "artifact": {
      "parts": [{ "text": "åœ¨" }]
    }
  }
}

// Event N: ä»»å‹™çµæŸ
{
  "result": {
    "id": "travel-task-123",
    "final": true
  }
}
```

---

## ğŸ” è§€å¯Ÿå°è©±æµç¨‹

æ‚¨å°‡åœ¨çµ‚ç«¯æ©Ÿçœ‹è¦‹ä»¥ä¸‹äº”å€‹å›åˆï¼š

1.  **éœ€æ±‚æå‡º**ï¼šè€é—†é€é PA è©¢å•é£¯åº—ã€‚
2.  **ç²¾ç¢ºå»ºè­°**ï¼šTF (è²¡å‹™) æ ¹æ“šå…¬å¸æ”¿ç­–å›å‚³é£¯åº—é¸é …ã€‚
3.  **ç´°ç¯€ç¢ºèª**ï¼šPA é¸æ“‡é£¯åº—ä¸¦è¦æ±‚è¨‚é«˜éµã€‚
4.  **è²¡å‹™åˆè¦**ï¼šTF è¦æ±‚æä¾›å‡ºå·®äº‹ç”±ä»¥åˆ©å ±å¸³ã€‚
5.  **ä¸²æµçµæ¡ˆ**ï¼šæœ€å¾Œä¸€å›åˆå±•ç¤º **SSE**ã€‚æ‚¨æœƒçœ‹åˆ° TF ä¸€æ­¥æ­¥æ¨é€ã€Œæ­£åœ¨æª¢æŸ¥æ”¿ç­–...ã€ã€ã€Œæ­£åœ¨ç”Ÿæˆ PDF...ã€ï¼Œé€™è­‰æ˜äº† A2A åœ¨è™•ç†é•·æ™‚ä»»å‹™æ™‚çš„å„ªå‹¢ã€‚

---

## ğŸ›  æŠ€è¡“æ¶æ§‹
*   **é€šè¨Šå”å®š**: HTTP POST + JSON-RPC 2.0
*   **æ•¸æ“šæ¨¡å‹**: ä½¿ç”¨ A2A æ¨™æº– `Message`, `Task`, `Artifact` çµæ§‹ã€‚
*   **ç„¡ä¾è³´è¨­è¨ˆ**: å®Œå…¨ä½¿ç”¨ Go æ¨™æº–åº«ï¼Œç¬¦åˆé«˜æ•ˆç‡ã€è¼•é‡åŒ–åŸå‰‡ã€‚

---

## ğŸ“š åƒè€ƒè³‡æº

*   **å®˜æ–¹ç¯„ä¾‹åº«**: [https://github.com/a2aproject/a2a-samples/](https://github.com/a2aproject/a2a-samples/)
*   **A2A å”å®šæ–‡ä»¶**: [https://a2a-protocol.org/latest/](https://a2a-protocol.org/latest/)
